<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>魅族 EP3C 耳机</title>
    <link rel="stylesheet" href="../dist/css/product.min.css">
    <link rel="stylesheet" href="../dist/css/swiper-3.4.2.min.min.css">
</head>

<body>
    <!-- header -->
    <header>
        <div class="headerCon" id="top">
            <div class="headerLeft"><img src="img/logo1.png" alt=""></div>
            <div class="headerCenter">
                <ul>
                    <li class="one"><a href="#">手机</a></li>
                    <li><a href="#">声学</a></li>
                    <li><a href="#">配件</a></li>
                    <li><a href="#">生活</a></li>
                    <li><a href="#">Flyme</a></li>
                    <li><a href="#">服务</a></li>
                    <li><a href="#">专卖店</a></li>
                    <li><a href="#">社区</a></li>
                    <li><a href="#">企业服务</a></li>
                    <li><a href="#">APP下载</a></li>
                </ul>
            </div>
            <div class="headerRight">
                <ul>
                    <li><input type="button" value="" id="search"></li>
                    <li><a href="login.html" class="login">登录</a></li>
                    <li class="buy"><input type="button" value="" id="buy"></li>
                </ul>

            </div>
        </div>
    </header>
    <!-- <div class="nav-one">
        <ul>
            <li>
                <a href="#">
                    <img src="img/p1.png" alt="">
                    <div class="nav-tit">魅族</div>
                    <div class="nav-price">￥3499</div>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="img/p2.png" alt="">
                    <div class="nav-tit">魅族</div>
                    <div class="nav-price">￥3499</div>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="img/p3.png" alt="">
                    <div class="nav-tit">魅族</div>
                    <div class="nav-price">￥3499</div>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="img/p4.png" alt="">
                    <div class="nav-tit">魅族</div>
                    <div class="nav-price">￥3499</div>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="img/p5.png" alt="">
                    <div class="nav-tit">魅族</div>
                    <div class="nav-price">￥3499</div>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="img/p6.png" alt="">
                    <div class="nav-tit">魅族</div>
                    <div class="nav-price">￥3499</div>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="img/p4.png" alt="">
                    <div class="nav-tit">魅族</div>
                    <div class="nav-price">￥3499</div>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="img/p2.png" alt="">
                    <div class="nav-tit">魅族</div>
                    <div class="nav-price">￥3499</div>
                </a>
            </li>
        </ul>
    </div> -->

    <!-- banner -->
    <div class="banner">
        <div class="bannerCon">
            <div class="bannerLeft">
                <div class="view">
                    <div class="swiper-container">
                        <div class="swiper-wrapper" style="transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;">
                            <div class="swiper-slide">
                                <a href="#" target="_blank"><img src="img/pro1.jpg" alt=""></a>
                            </div>
                            <div class="swiper-slide">
                                <a href="#" target="_blank"><img src="img/pro2.jpg" alt=""></a>
                            </div>
                            <div class="swiper-slide">
                                <a href="#" target="_blank"><img src="img/pro3.jpg" alt=""></a>
                            </div>
                            <div class="swiper-slide">
                                <a href="#" target="_blank"><img src="img/pro4.jpg" alt=""></a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="preview">
                    <div class="swiper-container swiper-container-horizontal">
                        <div class="swiper-wrapper" style="transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;">
                            <div class="swiper-slide">
                                <img src="img/pro1.jpg" alt="">
                            </div>
                            <div class="swiper-slide">
                                <img src="img/pro2.jpg" alt="">
                            </div>
                            <div class="swiper-slide">
                                <img src="img/pro3.jpg" alt="">
                            </div>
                            <div class="swiper-slide">
                                <img src="img/pro4.jpg" alt="">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="bannerRight">
                <div class="br-tit">魅族 EP3C 耳机</div>
                <div class="br-intro">【APP限时抢购99元】Hi-Res 认证高解析音质 | Type-C数字接口 | 高保真生物纤维振膜</div>
                <div class="br-box">
                    <div class="brb-price"><span>￥</span>129.99</div>
                    <div class="brb-con">
                        <div class="brb-con_one">优惠券</div>
                        <div class="brb-con_two">满129减30</div>
                        <div class="brb-con_three">更多></div>
                    </div>
                </div>
                <div class="br-support">
                    <span>支&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;持</span>
                    <span>花呗分期</span>
                    <span>顺丰发货</span>
                    <span>7天无理由退货</span>
                </div>
                <div class="br-service">
                    <span>配送服务</span>
                    <span>山西省 太原市</span><br>
                    <span class="three">本商品由 魅族 负责发货并提供售后服务</span>
                    <span class="four">商城客服</span>
                </div>

                <div class="br-type">
                    <div class="brt-tit">型&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;号</div>
                    <ul>
                        <li>EC3P</li>
                        <li>APP限时抢购</li>
                        <li>EP21</li>
                    </ul>
                </div>
                <div class="br-type">
                    <div class="brt-tit">颜色分类</div>
                    <ul>
                        <li>白色</li>
                    </ul>
                </div>
                <div class="br-type">
                    <div class="brt-tit">花呗分期</div>
                    <ul>
                        <li>￥43.99✖️3期</li>
                        <li>￥22.46✖️6期</li>
                        <li>￥11.55✖️12期</li>
                    </ul>
                </div>
                <div class="br-number">
                    <div class="brn-tit">数&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;量</div>
                    <div class="brn-box">
                        <input type="button" value="-">
                        <div class="brnb-box"></div>
                        <input type="button" value="+">
                    </div>
                </div>
                <div class="br-cart">
                    <input type="button" value="立即购买" id="buy">
                    <input type="button" value="加入购物车" id="cart" class="addToCart">
                    <img src="img/m12.png" alt="">
                    <div>魅族 EP3C 耳机</div>
                    <div>129.99</div>
                </div>

            </div>
        </div>
    </div>

    <!-- list -->
    <div class="list">
        <div class="listCon">
            <ul>
                <li><a href="#">商品详情<span class="xq"></span></a></li>
                <li><a href="#">规格参数<span></span></a></li>
            </ul>
        </div>
    </div>

    <!-- content -->
    <div class="content">
        <div class="contentCon">
            <img src="img/con1.jpg" alt="">
            <img src="img/con2.jpg" alt="">
            <img src="img/con3.jpg" alt="">
        </div>
        <ul>
            <li class="goSuggest">
                <a href="login.html"><img src="img/span1.png" alt=""></a>
            </li>
            <li class="goTop">
                <a href="#top"><img src="img/span2.png" alt=""></a>
            </li>
        </ul>
    </div>


    <!-- footer -->
    <footer>
        <div class="footerCon">
            <div class="footer-top">
                <div class="ft-left">
                    <ul>
                        <li>
                            <a href="#">
                                <img src="img/t1.png" alt="">
                                <div>满80免运费</div>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <img src="img/t2.png" alt="">
                                <div>满80免运费</div>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <img src="img/t3.png" alt="">
                                <div>满80免运费</div>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <img src="img/t4.png" alt="">
                                <div>满80免运费</div>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <img src="img/t5.png" alt="">
                                <div>满80免运费</div>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <img src="img/t6.png" alt="">
                                <div>满80免运费</div>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="ft-right">
                    <div class="time">周一至周日 8:00-20:00</div>
                    <div class="ft-phone">400-788-3333</div>
                    <div class="kefu"><a href="#">在线客服</a></div>
                </div>
            </div>
            <div class="footer-bottom">
                <div class="fb-left">
                    <ul>
                        <li><a href="#">了解魅族</a></li> |
                        <li><a href="#">加入我们</a></li> |
                        <li><a href="#">联系我们</a></li> |
                        <li><a href="#">Flyme</a></li> |
                        <li><a href="#">魅族社区</a></li> |
                        <li><a href="#">天猫旗舰店</a></li> |
                        <li><a href="#">问题反馈</a></li> |
                        <li><a href="#">线上销售授权名单公示</a></li> |
                        <li><a href="#">出版物经营许可证</a></li> |
                        <li><a href="#">简体中文</a></li>
                    </ul>
                    <div>&copy;2019 Meizu Telecom Equipment Co., Ltd. All rights reserved. 粤ICP备13003602号合字B2-20170010 营业执照法律声明粤公网安备 44049102496009 号</div>
                </div>
                <div class="fb-right">
                    <ul>
                        <li>
                            <a href="#">
                                <img src="img/ff1.png" alt="">
                                <div class="lianjie"><img src="img/lianjie.png" alt=""></div>
                            </a>
                        </li> |
                        <li>
                            <a href="#">
                                <img src="img/ff2.png" alt="">
                                <div class="lianjie wechat"><img src="img/weixin.png" alt=""></div>
                            </a>
                        </li> |
                        <li>
                            <a href="#"><img src="img/ff3.png" alt=""></a>
                        </li> |
                        <li>
                            <a href="#"><img src="img/ff4.png" alt=""></a>
                        </li> |
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <!-- script -->
    <script src="../dist/js/jquery-1.12.4.min.min.js"></script>
    <script src="../dist/js/jquery.cookie.min.js"></script>
    <script src="../dist/js/public.min.js"></script>
    <script src="../dist/js/jquery.fly.min.min.js"></script>
    <script src="../dist/js/requestAnimationFrame.min.js"></script>
    <script src="../dist/js/swiper-3.4.2.min.min.js"></script>
    <script>
        let $buy = $('#buy');
        init();
        $buy.click(() => {
            location.href = 'cart.html';
        })
        let $to_cart = $('.addToCart');
        //遍历添加事件
        $to_cart.each(function(i, value) {
            $(value).on('click', (event) => {
                //商品id
                let good_id = $(this).parent().attr('data-good-id');
                //商品名称
                let good_name = $(this).next().next().text();

                //商品src
                let good_src = $(this).next().attr('src');
                //商品价格
                let good_price = $(this).next().next().next().text();

                //判断购物车中是否存在 
                //获取cookie
                let cookie_str = $.cookie('carts') ? $.cookie('carts') : '';
                //转对象
                let cookie_obj = $toObj(cookie_str);
                //判断对象中是否存在当前购买的商品
                if (good_id in cookie_obj) {
                    cookie_obj[good_id].num++;
                } else {
                    cookie_obj[good_id] = {
                        "name": good_name,
                        "src": good_src,
                        "price": good_price,
                        "num": 1
                    }
                }
                $.cookie('carts', JSON.stringify(cookie_obj), {
                    expires: 7,
                    path: '/'
                });

                //获取图片---飞
                let $img = $(this).siblings('img').clone().css({
                    width: 50,
                    height: 50
                });
                $img.fly({
                    start: {
                        left: event.pageX,
                        top: event.pageY
                    },
                    end: {
                        left: $buy.offset().left,
                        top: $buy.offset().top,
                        width: 0,
                        height: 0
                    },
                    onEnd: function() {
                        var num = parseInt(/(\d+)/.exec($buy.val())[1]);
                        $buy.val(`${++ num}`)
                    }
                });
            })
        })

        function init() {
            //获取cookie
            let cookie_str = $.cookie('carts') ? $.cookie('carts') : '';
            //转对象
            let cookie_obj = $toObj(cookie_str);
            let sum = 0;
            for (let i in cookie_obj) {
                sum += cookie_obj[i].num;
            }
            $buy.val(`${sum}`)
        }

        // swiper
        var viewSwiper = new Swiper('.view .swiper-container', {
            onSlideChangeStart: function() {
                updateNavPosition()
            }
        })

        $('.view .arrow-left,.preview .arrow-left').on('click', function(e) {
            e.preventDefault()
            if (viewSwiper.activeIndex == 0) {
                viewSwiper.slideTo(viewSwiper.slides.length - 1, 1000);
                return
            }
            viewSwiper.slidePrev()
        })
        $('.view .arrow-right,.preview .arrow-right').on('click', function(e) {
            e.preventDefault()
            if (viewSwiper.activeIndex == viewSwiper.slides.length - 1) {
                viewSwiper.slideTo(0, 1000);
                return
            }
            viewSwiper.slideNext()
        })

        var previewSwiper = new Swiper('.preview .swiper-container', {
            //visibilityFullFit: true,
            slidesPerView: 'auto',
            allowTouchMove: false,
            onTap: function() {
                viewSwiper.slideTo(previewSwiper.clickedIndex)
            }
        })

        function updateNavPosition() {
            $('.preview .active-nav').removeClass('active-nav')
            var activeNav = $('.preview .swiper-slide').eq(viewSwiper.activeIndex).addClass('active-nav')
            if (!activeNav.hasClass('swiper-slide-visible')) {
                if (activeNav.index() > previewSwiper.activeIndex) {
                    var thumbsPerNav = Math.floor(previewSwiper.width / activeNav.width()) - 1
                    previewSwiper.slideTo(activeNav.index() - thumbsPerNav)
                } else {
                    previewSwiper.slideTo(activeNav.index())
                }
            }
        }
    </script>
</body>

</html>